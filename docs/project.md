# 📄 Mob Switch MOD 仕様書（軽量・マルチ対応版）

## 1. 概要

| 項目             | 内容                               |
| -------------- | -------------------------------- |
| MOD名称          | SimpleMobSwitch       |
| 対象ゲーム          | Minecraft Java Edition           |
| サーバー対応         | ✔ マルチプレイサーバー（Dedicated Server）対応 |
| クライアント対応       | ❌ 不要（サーバーサイドMOD）                 |
| MODローダー        | Fabric         |
| 主な機能           | 敵対モブの自然湧きを間接的に停止・再開する制御機能        |

---

## 2. 機能詳細

### ✅ 2.1 コマンドによるON/OFF制御

| コマンド             | 説明                             |
| ---------------- | ------------------------------ |
| `/mobswitch on`  | 敵対モブが湧かない状態を強制する（MobSwitch有効化） |
| `/mobswitch off` | 元の状態に戻す（MobSwitch無効化）          |

* 実行対象：OPユーザー or サーバーコンソール
* 成功時：チャットログに成功メッセージ表示
* 失敗時：理由付きエラーメッセージ表示

---

### ✅ 2.2 ON時の挙動

* モブスポーン制限数（例：70体）に達するように、**`NoAI`属性付きのダミーMob（Zombie）を召喚**
* 特徴：

  * 湧き上限により他エリアでの敵対Mobスポーンが抑制される
  * スポーンチャンクに配置することで常にロードされる
  * `NoAI`+`Silent`+`上空設置（例：Y=500）`で描画・音声・処理負荷ゼロ
  * `CustomName = "MobSwitchDummy"`を設定し、明示的に管理

---

### ✅ 2.3 OFF時の挙動

* 有効化時に生成したダミーMobを全削除
* 削除条件：名前付き（"MobSwitchDummy"）かつ該当エリアにいるモブのみ

---

## 3. 技術仕様

### ✅ 3.1 エンティティ仕様

| 属性  | 値                                                                 |
| --- | ----------------------------------------------------------------- |
| 種類  | Zombie（変更可能）                                                      |
| AI  | 無効（`NoAI = true`）                                                 |
| 音声  | 無音（`Silent = true`）                                               |
| HP  | 任意（不要なら変更しない）                                                     |
| その他 |`Invisible`,`NoGravity`,  `PersistenceRequired = true`（デスポーン防止）、`Invulnerable = true`（ダメージ耐性） |

---

### ✅ 3.2 内部処理

| 項目     | 実装内容                                                       |
| ------ | ---------------------------------------------------------- |
| 状態管理   | `PersistentState`（Fabric）でON/OFF状態保持 |
| 多重実行防止 | ON状態で再度 `/mobswitch on` 実行時は無視                             |
| 高速化対策  | 処理はすべてサーバースレッドで非同期化不要                                      |
| マルチ対策  | 各ディメンションごとに個別のMobSwitchを制御可能（オプション）                        |

---

## 4. デプロイ・利用方法

| 手順 | 内容                                |
| -- | --------------------------------- |
| 1  | MODファイル（.jar）を `/mods` ディレクトリに配置  |
| 2  | サーバー起動時に自動読み込み                    |
| 3  | OP権限でコマンド `/mobswitch on/off` を実行 |

---

## 5. 拡張オプション（将来的に）

| オプション      | 説明                           |
| ---------- | ---------------------------- |
| カスタムモブ種別指定 | Pigなど軽量なエンティティで実装可能に         |
| 自動起動設定     | サーバー起動時に自動でON状態にするフラグ追加      |
| GUI対応      | Fabricの場合、クライアントMODでGUI制御も可能 |

---

## 6. 前提と制約

* **Mob Switchはスポーン制限を前提とした設計であり、バニラのルールに依存**します
* 他のスポーン制御MOD（例：Carpet MOD、Paperの設定等）と併用する場合、競合に注意
* サーバーパフォーマンスへの影響は最小限ですが、低スペックサーバーではテストを推奨

---
